import{b6 as b,b9 as T,bd as y,r as u,c as n,o as l,g as i,d as c,y as p,bf as C,aG as _,aq as d,t as h,f as w,A as m,V as k,ao as S,ap as M,be as B,b7 as L,b8 as I,bb as H}from"./_plugin-vue_export-helper-BemuwRpB.chunk.mjs";import{M as x,l as V}from"./logger-Dn3kbj54.chunk.mjs";/* empty css                     */const A={name:"RegistrationApp",components:{NcModal:y,ModalContent:x},data(){return{showModal:!1,hasSigned:!1,terms:{},languages:[],selectedLanguage:0,termsId:0,termsBody:"",publicContent:null,hasScrolledToBottom:!1}},watch:{selectedLanguage(e){this.selectTerms(e)}},mounted(){this.loadTerms()},methods:{async loadTerms(){try{const e=await L.get(I("/apps/terms_of_service/terms"));this.terms=e.data.ocs.data.terms;const s=OC.getLanguage().split("-")[0];if(!this.terms.length||this.hasSigned)return;this.publicContent=document.getElementById("files-public-content"),this.publicContent!==null&&(this.publicContent.style.visibility="hidden"),this.selectTerms(0),this.terms.length>1&&Object.keys(this.terms).forEach(r=>{s===this.terms[r].languageCode&&(this.selectedLanguage=r),this.languages.push(e.data.ocs.data.languages[this.terms[r].languageCode])})}catch(e){V.error(e)}},selectTerms(e){this.termsBody=this.terms[e].renderedBody,this.termsId=this.terms[e].id},showTerms(){if(this.hasSigned){this.hasSigned=!1;return}this.showModal=!0,this.$nextTick(()=>{this.checkScroll()})},checkScroll(){const e=this.$refs.termsContent,s=e.scrollHeight>e.clientHeight;this.hasScrolledToBottom=!s||e.scrollHeight-e.scrollTop<=e.clientHeight+1},acceptTerms(){this.hasSigned=!0,this.showModal=!1},handleCloseModal(){this.showModal=!1},t:T}},E={id:"terms_of_service"},K={key:0},N=["value"],O={id:"terms_of_service_confirm"},U=["value"],j=["innerHTML"];function q(e,s,r,R,o,a){const f=u("ModalContent"),v=u("NcModal");return l(),n("div",E,[o.terms.length?(l(),n("p",K,[p(c("input",{id:"terms_of_service_accepted","onUpdate:modelValue":s[0]||(s[0]=t=>o.hasSigned=t),value:o.termsId,type:"checkbox",name:"terms_of_service_accepted",class:"checkbox",onKeydown:s[1]||(s[1]=_(d((...t)=>a.showTerms&&a.showTerms(...t),["prevent","stop"]),["enter"]))},null,40,N),[[C,o.hasSigned]]),c("label",{for:"terms_of_service_accepted",onClick:s[2]||(s[2]=d((...t)=>a.showTerms&&a.showTerms(...t),["prevent","stop"])),onKeydown:s[3]||(s[3]=_(d((...t)=>a.showTerms&&a.showTerms(...t),["prevent","stop"]),["enter"]))},h(a.t("terms_of_service","I acknowledge that I have read and agree to the above terms of service"))+" â†— ",33)])):i("",!0),c("div",O,[o.showModal?(l(),w(v,{key:0,"no-close":!o.hasSigned,onClose:a.handleCloseModal},{default:m(()=>[k(f,{"is-scroll-complete":o.hasScrolledToBottom,onClick:a.acceptTerms},{header:m(()=>[c("h3",null,h(a.t("terms_of_service","Terms of service")),1),o.terms.length>1?p((l(),n("select",{key:0,"onUpdate:modelValue":s[4]||(s[4]=t=>o.selectedLanguage=t)},[(l(!0),n(S,null,M(o.languages,(t,g)=>(l(),n("option",{key:g,value:g},h(t),9,U))),128))],512)),[[B,o.selectedLanguage]]):i("",!0)]),default:m(()=>[c("div",{ref:"termsContent",class:"text-content",onScroll:s[5]||(s[5]=(...t)=>a.checkScroll&&a.checkScroll(...t)),innerHTML:o.termsBody},null,40,j)]),_:1},8,["is-scroll-complete","onClick"])]),_:1},8,["no-close","onClose"])):i("",!0)])])}const G=b(A,[["render",q],["__scopeId","data-v-86b36221"]]);H(G,{source:"public"}).mount("#terms_of_service");
//# sourceMappingURL=terms_of_service-registration.mjs.map
